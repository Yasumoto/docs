<!DOCTYPE html>
<html class="no-js">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">

    <meta name="theme-color" content="#574e4a">

    <title>Pop!_OS 20.10 Incomplete Upgrade - System76 Support</title>
    <meta property="og:title" content="Pop!_OS 20.10 Incomplete Upgrade - System76 Support">
    <meta itemprop="name" content="Pop!_OS 20.10 Incomplete Upgrade - System76 Support">
    <meta name="twitter:title" content="Pop!_OS 20.10 Incomplete Upgrade - System76 Support">

    <meta name="description" content="What to do if you get an FStab error or if your upgrade is incomplete.
">
    <meta property="og:description" content="What to do if you get an FStab error or if your upgrade is incomplete.
">
    <meta itemprop="description" content="What to do if you get an FStab error or if your upgrade is incomplete.
">
    <meta name="twitter:description" content="What to do if you get an FStab error or if your upgrade is incomplete.
">

    <meta name="keywords" content="Pop!_OS 20.10 Pop!_OS 20.04 LTS Non-LTS Upgrade Update Release System76 apt">

    
    <meta property="og:image" content="http://support.system76.com/images/pop-icon.png" />
    <meta name="twitter:image:src" content="http://support.system76.com/images/pop-icon.png">
    

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@system76">
    <meta name="twitter:creator" content="@system76">


    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://system76.com/images/touch-icon-iphone-retina.png">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://system76.com/images/touch-icon-ipad-retina.png">
    <link rel="touch-icon" sizes="196x196" href="https://system76.com/images/icon-196.png">
    <link rel="icon" sizes="196x196" href="https://system76.com/images/icon-196.png">

    <link rel="stylesheet" type="text/css" media="all" href="https://system76.com/stylesheets/app.css">
    <link rel="stylesheet" href="/css/main.css">

    <!--[if lt IE 10]><script>document.documentElement.className += " legacy";</script><![endif]-->

        <script>
        (function() {
            var _fbq = window._fbq || (window._fbq = []);
            if (!_fbq.loaded) {
                var fbds = document.createElement('script');
                fbds.async = true;
                fbds.src = '//connect.facebook.net/en_US/fbds.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(fbds, s);
                _fbq.loaded = true;
            }
        })();
        window._fbq = window._fbq || [];
        </script>

        <script src="//platform.twitter.com/oct.js" type="text/javascript"></script>

        <script>
        var fbSent = false;

        function facebookStatusChangeCallback(response) {
            if (response.status === 'connected' && fbSent) {
                window.oauthSuccess('facebook', response.authResponse.accessToken);
            }
        }

        function facebookCheckLoginState() {
            FB.getLoginStatus(function(response) {
                facebookStatusChangeCallback(response);
            });
        }

        function facebookLogin() {
            fbSent = true;
            FB.login(
                facebookCheckLoginState,
                {
                    scope: 'email'
                }
            );
        }

        window.fbAsyncInit = function() {
            FB.init({
                appId: '346948125501334',
                cookie: true,
                xfbml: true,
                version: 'v2.1'
            });

            FB.getLoginStatus(function(response) {
                facebookStatusChangeCallback(response);
            });
        };

        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
        </script>

        <script>
        function githubLogin() {
            var gitHubWindow = popupCenter(
                "https://github.com/login/oauth/authorize?" +
                "client_id=dc1b6955f316f6f4633b" +
                "&scope=user,user:email",
                "GitHub"+Date.now(),
                1024,
                600
            );
        }
        </script>

        <meta name="google-signin-clientid" content="118911812273-tsqn79u4hm451chlbhm1gkkt63ttgoq9.apps.googleusercontent.com" />
        <meta name="google-signin-scope" content="email" />
        <meta name="google-signin-cookiepolicy" content="single_host_origin" />
        <script src="https://apis.google.com/js/client:platform.js?onload=googleRender" async defer></script>

        <script>
        function googleLogin() {
            gapi.auth.signIn({
                'callback': googleSigninCallback
            });
        }

        function googleSigninCallback(authResult) {
            if (authResult['status']['signed_in']) {
                if( authResult['status']['method'] == 'PROMPT' ) {
                    window.oauthSuccess("google", authResult['access_token']);
                }
            }
        }
        </script>

        <link href="https://cdn.rawgit.com/Lukas-W/font-linux/v0.5/assets/font-linux.css" rel="stylesheet">

</head>

  <body class="path-support">
    <div id="page-container">
        <header id="masthead" class="main">
	<nav>
		<a id="logo" class="home" href="https://system76.com"></a>

		<ul class="quick" id="nav-links">
			<li>
				<a id="link-contact" href="https://system76.com/contact" title="Contact">
					<i class="fa fa-comments"></i>
					Contact
				</a>
			</li>

			<li>
				<a id="link-support" href="https://support.system76.com" title="Support">
					<i class="fa fa-life-ring"></i>
					Support
				</a>
			</li>

			<li>
				<a id="link-account" href="https://system76.com/my-account" title="Account">
					<i class="fa fa-user"></i>
					Account
				</a>
			</li>
		</ul>

		<ul id="nav-links" class="categories">
			<li><a href="https://system76.com/laptops">Laptops</a></li>
			<li><a href="https://system76.com/desktops">Desktops</a></li>
			<li><a href="https://system76.com/desktops/meerkat">Mini</a></li>
			<li><a href="https://system76.com/servers">Servers</a></li>
			<li><a href="https://system76.com/pop">Pop!_OS</a></li>
		</ul>
	</nav>
</header>


  <header id="page-title">
    <div class="row">
      <h1 class="small-12 columns greeting">
        <a href="/" title="Back to Support"><i class="fa fa-arrow-left"></i></a>
        Pop!_OS 20.10 Incomplete Upgrade
        <a href="https://github.com/system76/docs/edit/master/_articles/pop-20.10-upgrade-help.md" class="button"><i class="fa fa-github"></i> Edit on GitHub</a>
      </h1>
    </div>
  </header>


        <div class="row">
    <div class="small-12 small-centered medium-10 large-8 columns">
        <h1 id="pop_os-2010-incomplete-upgrade">Pop!_OS 20.10 Incomplete Upgrade</h1>

<h3 id="backup-your-files">Backup Your Files</h3>
<p>The upgrade process will leave your files intact, but it’s always a good idea to play it safe and create a backup of any important files. Please read our article on <a href="/articles/backup-files/">how to backup your files</a> for helpful instructions.</p>

<h3 id="fstab-error-message">FStab Error Message</h3>

<p>This can be caused by the <code class="language-plaintext highlighter-rouge">pop-upgrade</code> command checking for an <code class="language-plaintext highlighter-rouge">/etc/fstab</code> file and finding an entry that it does not understand. If you have manually added drives to your fstab, adding a ‘#’ to comment out the drive while the upgrade is ongoing should work.  You would then remove the comment after the upgrade is complete to have access to those drive paths again. To edit this file, run the following command in a terminal:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>gedit /etc/fstab
</code></pre></div></div>

<p>For example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dev/disk/by-id/usb-ST1000LM_02123AD2-0:0-part1 /media/system76/game_drive auto nosuid,nodev,nofail,x-gvfs-show 0 0
</code></pre></div></div>

<p>would become:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#/dev/disk/by-id/usb-ST1000LM_02123AD2-0:0-part1 /media/system76/game_drive auto nosuid,nodev,nofail,x-gvfs-show 0 0</span>
</code></pre></div></div>

<p>If it is showing by UUID, the example would change from:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dev/disk/by-uuid/ed6c6976-973f-40e5-969b-9d4238fb7e00 /media/system76/ExtraDrive auto nosuid,nodev,nofail,x-gvfs-show 0 0
</code></pre></div></div>

<p>To:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#/dev/disk/by-uuid/ed6c6976-973f-40e5-969b-9d4238fb7e00 /media/system76/ExtraDrive auto nosuid,nodev,nofail,x-gvfs-show 0 0</span>
</code></pre></div></div>

<p>After you have made the edit, save the file and start the upgrade again.</p>

<h3 id="repair-package-manager-after-failedincomplete-upgrade">Repair Package Manager after Failed/Incomplete Upgrade</h3>

<ol>
  <li>If you’re able to log in and have a graphical interface, let’s try running a set of commands in a terminal (click your activities menu and type ‘t’ for ‘terminal’) to clean up the installed packages:</li>
</ol>

<p><strong>If this is your first time running commands, just a heads up- after each command, press the enter key. When the system prompts you for your password, type it in the terminal and press the enter key. The password will not show in the terminal, but it is taking the password)</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt clean
<span class="nb">sudo </span>apt update <span class="nt">-m</span>
<span class="nb">sudo </span>dpkg <span class="nt">--configure</span> <span class="nt">-a</span>
<span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-f</span>
<span class="nb">sudo </span>apt dist-upgrade
<span class="nb">sudo </span>apt autoremove <span class="nt">--purge</span>
</code></pre></div></div>

<p>If you are not able to get to the desktop to run those commands, try to get to a TTY (Ctrl+Alt+F5). Enter the username and password as requested and proceed with the commands above.</p>

<p>If you cannot access the desktop or TTY, we can run the package repair commands in Pop Recovery instead. To do this,</p>

<p>1A. Turn your computer off, then turn it back on and hold down the space bar immediately. In the menu that appears, select Pop!_OS Recovery, and let it boot.</p>

<p>1B. Once it boots, close out of the installation window or choose “Try Demo Mode” (be sure not to choose any install or repair options, as this could result in data loss).</p>

<p><strong>If you do not have a Pop Recovery option, you can create a live disk image of the OS and follow the next steps to mount the installed OS while running in a live disk. To create a live disk, use the instructions in the following <a href="/articles/live-disk">article</a>, then proceed to the next step.</strong></p>

<ol>
  <li>
    <p>Connect to your network</p>
  </li>
  <li>
    <p>Mount the installed OS and “chroot” into the main OS. Chroot or “change root” lets us run commands as if we were logged in normally.</p>
  </li>
</ol>

<p>To mount the OS, make note of what type of drive your OS is installed on. Is it an NVME or a SATA drive? You can run the following command to confirm:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>parted <span class="nt">-ls</span>
</code></pre></div></div>

<p>Look for the name of your main hard drive. It could be <code class="language-plaintext highlighter-rouge">/dev/sda</code> or <code class="language-plaintext highlighter-rouge">/dev/nvme0n1</code>, depending on if you have a standard SATA drive, or an NVMe drive, respectively. Input the following commands based on your drive type:</p>

<p><strong>If disk is encrypted, start with these first 3 commands using the correct drive name in the /dev filepath</strong>:</p>

<p><strong>For SATA Drives</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mount /dev/sda3 /mnt
</code></pre></div></div>

<p><strong>For NVMe Drives</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mount /dev/nvme0n1p3 /mnt
</code></pre></div></div>

<p>If the command fails and says <code class="language-plaintext highlighter-rouge">mount: /mnt: unknown filesystem type 'crypto_LUKS'</code>, then the hard drive has been encrypted, and additional commands are needed to unlock it.</p>

<p><strong>For SATA Drives</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>cryptsetup luksOpen /dev/sda3 cryptdata
<span class="nb">sudo </span>lvscan
<span class="nb">sudo </span>vgchange <span class="nt">-ay</span>
</code></pre></div></div>

<p><strong>For NVMe Drives</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>cryptsetup luksOpen /dev/nvme0n1p3 cryptdata
<span class="nb">sudo </span>lvscan
<span class="nb">sudo </span>vgchange <span class="nt">-ay</span>
</code></pre></div></div>
<p>Next we will mount the now decrypted drive:</p>

<p><strong>NOTE:</strong> Pay attention to what the cryptdata group is called. If it is named something other than ‘data-root’ then you will need to substitute the correct info into this next command. Make sure that -root is on the end.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mount /dev/mapper/data-root /mnt
</code></pre></div></div>

<p>Next we will need to mount the required paths for the chroot to function.</p>

<p><strong>For SATA Drives</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mount /dev/sda1 /mnt/boot/efi
<span class="k">for </span>i <span class="k">in</span> /dev /dev/pts /proc /sys /run<span class="p">;</span> <span class="k">do </span><span class="nb">sudo </span>mount <span class="nt">-B</span> <span class="nv">$i</span> /mnt<span class="nv">$i</span><span class="p">;</span> <span class="k">done
</span><span class="nb">sudo cp</span> <span class="nt">-n</span> /etc/resolv.conf /mnt/etc/
<span class="nb">sudo chroot</span> /mnt
</code></pre></div></div>

<p><strong>For NVMe Drives</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mount /dev/nvme0n1p1 /mnt/boot/efi
<span class="k">for </span>i <span class="k">in</span> /dev /dev/pts /proc /sys /run<span class="p">;</span> <span class="k">do </span><span class="nb">sudo </span>mount <span class="nt">-B</span> <span class="nv">$i</span> /mnt<span class="nv">$i</span><span class="p">;</span> <span class="k">done
</span><span class="nb">sudo cp</span> <span class="nt">-n</span> /etc/resolv.conf /mnt/etc/
<span class="nb">sudo chroot</span> /mnt
</code></pre></div></div>

<p><strong>If you get an error about the <code class="language-plaintext highlighter-rouge">/etc/resolv/conf</code> file being the same, you can safely ignore it.</strong></p>

<ol>
  <li>Once the installed OS is mounted, we can attempt to repair it by running the following commands:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt clean
<span class="nb">sudo </span>apt update <span class="nt">-m</span>
<span class="nb">sudo </span>dpkg <span class="nt">--configure</span> <span class="nt">-a</span>
<span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-f</span>
<span class="nb">sudo </span>apt dist-upgrade
<span class="nb">sudo </span>apt autoremove <span class="nt">--purge</span>
</code></pre></div></div>

<ol>
  <li>If there are no errors, run the next commands to exit the terminal and reboot.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exit
</span>reboot
</code></pre></div></div>

    </div>
    <div class="small-12 small-centered medium-10 large-8 columns timestamp">
        <p>Article last modified: 2021-06-04</p>
    </div>
</div>

    </div>
    <footer id="foot">
    <div id="foot-links" class="row">
        <ul class="small-5 medium-2 columns">
            <li><a href="https://system76.com/contact">Contact</a></li>
            <li><a href="https://system76.com/support">Support</a></li>
            <li><a href="https://system76.com/about">About Us</a></li>
            <li><a href="http://blog.system76.com">Blog</a></li>
            <li><a href="https://system76.com/careers">Careers</a></li>
        </ul>
        <ul class="small-7 medium-4 columns">
            <li><a href="https://system76.com/shipping">Shipping Information</a></li>
            <li><a href="https://system76.com/warranty">Warranty &amp; Returns</a></li>
            <li><a href="https://system76.com/privacy">Privacy Policy</a></li>
            <li><a href="https://system76.com/disclaimer">Disclaimer</a></li>
            <li><a href="https://system76.com/terms">Terms &amp; Conditions</a></li>
        </ul>
        <ul id="social-links" class="small-12 medium-6 columns">
            <li><a href="https://www.facebook.com/system76/"><i class="fa fa-facebook"></i></a></li>
            <li><a href="https://twitter.com/system76/"><i class="fa fa-twitter"></i></a></li>
            <li><a href="https://www.pinterest.com/system76/"><i class="fa fa-pinterest"></i></a></li>
        </ul>
    </div>
    <div id="copyright" class="text-center">Copyright &copy; 2021 System76, Inc. </div>

    <div class="disclaimer text-center">* All financing prices are based on the advertised price at 10% APR paid over 12 months.</div>

    <div id="trademarks" class="text-center">Intel, the Intel Logo, Intel Core, and Xeon are trademarks of Intel Corporation in the U.S. and/or other countries.</div>
</footer>

<script src="https://system76.com/scripts/thinkbott1k.js"></script>

<!--[if lt IE 10]>
<div id="legacy-warning">
<h1>System76 is built on modern web technologies your browser doesn&rsquo;t support.</h1>
<p>This version of Internet Explorer is out of date and may contain bugs or security vulnerabilities. Please <a href="http://browsehappy.com/">upgrade</a> to IE 11 or an alternative web browser.</p>
<p>If you have questions about an order or require support, feel free to <a href="/contact">contact us</a>.</p>
<div id="legacy-warning-buttons">
<a href="#" onClick="document.getElementById('legacy-warning').style.display = 'none';">Dismiss</a>
<a class="primary" href="http://browsehappy.com/">Learn More</a>
</div>
</div>
<![endif]-->

  </body>
</html>
