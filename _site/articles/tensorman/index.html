<!DOCTYPE html>
<html class="no-js">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">

    <meta name="theme-color" content="#574e4a">

    <title>Install and Use Tensorman - System76 Support</title>
    <meta property="og:title" content="Install and Use Tensorman - System76 Support">
    <meta itemprop="name" content="Install and Use Tensorman - System76 Support">
    <meta name="twitter:title" content="Install and Use Tensorman - System76 Support">

    <meta name="description" content="Use Tensorman to manage TensorFlow containers.
">
    <meta property="og:description" content="Use Tensorman to manage TensorFlow containers.
">
    <meta itemprop="description" content="Use Tensorman to manage TensorFlow containers.
">
    <meta name="twitter:description" content="Use Tensorman to manage TensorFlow containers.
">

    <meta name="keywords" content="NVIDIA CUDA TensorFlow Tensorman">

    
    <meta property="og:image" content="http://support.system76.com/images/system76.png" />
    <meta name="twitter:image:src" content="http://support.system76.com/images/system76.png">
    

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@system76">
    <meta name="twitter:creator" content="@system76">


    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://system76.com/images/touch-icon-iphone-retina.png">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://system76.com/images/touch-icon-ipad-retina.png">
    <link rel="touch-icon" sizes="196x196" href="https://system76.com/images/icon-196.png">
    <link rel="icon" sizes="196x196" href="https://system76.com/images/icon-196.png">

    <link rel="stylesheet" type="text/css" media="all" href="https://system76.com/stylesheets/app.css">
    <link rel="stylesheet" href="/css/main.css">

    <!--[if lt IE 10]><script>document.documentElement.className += " legacy";</script><![endif]-->

        <script>
        (function() {
            var _fbq = window._fbq || (window._fbq = []);
            if (!_fbq.loaded) {
                var fbds = document.createElement('script');
                fbds.async = true;
                fbds.src = '//connect.facebook.net/en_US/fbds.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(fbds, s);
                _fbq.loaded = true;
            }
        })();
        window._fbq = window._fbq || [];
        </script>

        <script src="//platform.twitter.com/oct.js" type="text/javascript"></script>

        <script>
        var fbSent = false;

        function facebookStatusChangeCallback(response) {
            if (response.status === 'connected' && fbSent) {
                window.oauthSuccess('facebook', response.authResponse.accessToken);
            }
        }

        function facebookCheckLoginState() {
            FB.getLoginStatus(function(response) {
                facebookStatusChangeCallback(response);
            });
        }

        function facebookLogin() {
            fbSent = true;
            FB.login(
                facebookCheckLoginState,
                {
                    scope: 'email'
                }
            );
        }

        window.fbAsyncInit = function() {
            FB.init({
                appId: '346948125501334',
                cookie: true,
                xfbml: true,
                version: 'v2.1'
            });

            FB.getLoginStatus(function(response) {
                facebookStatusChangeCallback(response);
            });
        };

        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
        </script>

        <script>
        function githubLogin() {
            var gitHubWindow = popupCenter(
                "https://github.com/login/oauth/authorize?" +
                "client_id=dc1b6955f316f6f4633b" +
                "&scope=user,user:email",
                "GitHub"+Date.now(),
                1024,
                600
            );
        }
        </script>

        <meta name="google-signin-clientid" content="118911812273-tsqn79u4hm451chlbhm1gkkt63ttgoq9.apps.googleusercontent.com" />
        <meta name="google-signin-scope" content="email" />
        <meta name="google-signin-cookiepolicy" content="single_host_origin" />
        <script src="https://apis.google.com/js/client:platform.js?onload=googleRender" async defer></script>

        <script>
        function googleLogin() {
            gapi.auth.signIn({
                'callback': googleSigninCallback
            });
        }

        function googleSigninCallback(authResult) {
            if (authResult['status']['signed_in']) {
                if( authResult['status']['method'] == 'PROMPT' ) {
                    window.oauthSuccess("google", authResult['access_token']);
                }
            }
        }
        </script>

        <link href="https://cdn.rawgit.com/Lukas-W/font-linux/v0.5/assets/font-linux.css" rel="stylesheet">

</head>

  <body class="path-support">
    <div id="page-container">
        <header id="masthead" class="main">
	<nav>
		<a id="logo" class="home" href="https://system76.com"></a>

		<ul class="quick" id="nav-links">
			<li>
				<a id="link-contact" href="https://system76.com/contact" title="Contact">
					<i class="fa fa-comments"></i>
					Contact
				</a>
			</li>

			<li>
				<a id="link-support" href="https://support.system76.com" title="Support">
					<i class="fa fa-life-ring"></i>
					Support
				</a>
			</li>

			<li>
				<a id="link-account" href="https://system76.com/my-account" title="Account">
					<i class="fa fa-user"></i>
					Account
				</a>
			</li>
		</ul>

		<ul id="nav-links" class="categories">
			<li><a href="https://system76.com/laptops">Laptops</a></li>
			<li><a href="https://system76.com/desktops">Desktops</a></li>
			<li><a href="https://system76.com/desktops/meerkat">Mini</a></li>
			<li><a href="https://system76.com/servers">Servers</a></li>
			<li><a href="https://system76.com/pop">Pop!_OS</a></li>
		</ul>
	</nav>
</header>


  <header id="page-title">
    <div class="row">
      <h1 class="small-12 columns greeting">
        <a href="/" title="Back to Support"><i class="fa fa-arrow-left"></i></a>
        Install and Use Tensorman
        <a href="https://github.com/system76/docs/edit/master/_articles/tensorman.md" class="button"><i class="fa fa-github"></i> Edit on GitHub</a>
      </h1>
    </div>
  </header>


        <div class="row">
    <div class="small-12 small-centered medium-10 large-8 columns">
        <h1 id="installing-tensorman">Installing Tensorman</h1>

<p><u>Tensorman</u> is a tool for managing TensorFlow toolchains in Pop!_OS. It can be installed with this command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>tensorman
</code></pre></div></div>

<p>For NVIDIA CUDA support, the following package must be installed:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>nvidia-container-runtime
</code></pre></div></div>

<p>The user account working with Tensorman must be added to the <code class="language-plaintext highlighter-rouge">docker</code> group if that hasn’t been done already:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>usermod <span class="nt">-aG</span> docker <span class="nv">$USER</span>
</code></pre></div></div>

<p>If Docker was just installed, then a reboot will be needed before Tensorman can be used.</p>

<h1 id="tensorman">Tensorman</h1>

<p>Packaging Tensorflow for Linux distributions is notoriously difficult, if not impossible. Every release of Tensorflow is accommodated by a myriad of possible build configurations, which requires building many variants of Tensorflow for each Tensorflow release. To make matters worse, each new version of Tensorflow will depend on a wide number of shared dependencies, which may not be supported on older versions of a Linux distribution, even if that distribution is actively supported by the distribution maintainers.</p>

<p>To solve this problem, the Tensorflow project provides official Docker container builds, which allow Tensorflow to operate in a contained environment that is isolated from the rest of the system. This virtual environment can operate independently of the base system, allowing you to use any version of Tensorflow on any version of a Linux distribution that supports the Docker runtime.</p>

<p>However, configuring and managing Docker containers for Tensorflow using the <code class="language-plaintext highlighter-rouge">docker</code> command line is currently tedious, and managing multiple versions for different projects is even more-so. To solve this problem for our users, we have developed <code class="language-plaintext highlighter-rouge">tensorman</code> as a convenient tool to manage the installation and execution of Tensorflow Docker containers. It condenses the command-line soup into a set of simple commands that are easy to memorize.</p>

<h1 id="comparison-to-docker-command">Comparison to Docker Command</h1>

<p>Take the following Docker invocation as an example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">-u</span> <span class="nv">$UID</span>:<span class="nv">$UID</span> <span class="nt">-v</span> <span class="nv">$PWD</span>:/project <span class="nt">-w</span> /project <span class="se">\</span>
    <span class="nt">--runtime</span><span class="o">=</span>nvidia <span class="nt">--init</span> <span class="nt">--rm</span> tensorflow/tensorflow:latest-gpu <span class="se">\</span>
    python ./script.py
</code></pre></div></div>

<p>This designates for the latest version of Tensorflow with GPU support to be used, mounting the working directory to <code class="language-plaintext highlighter-rouge">/project</code>, launching the container with the current user account, and and executing <code class="language-plaintext highlighter-rouge">script.py</code> with the Python binary in the container. With <code class="language-plaintext highlighter-rouge">tensorman</code>, we can achieve the same with:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman run <span class="nt">--gpu</span> python <span class="nt">--</span> ./script.py
</code></pre></div></div>

<p>Which defaults to the latest version, and whose version and tag variants can be set as defaults per-run, per-project, or user-wide.</p>

<h1 id="updating-and-installing-containers">Updating and installing containers</h1>

<p>The following commands can be used for installing either the latest version of a container or a certain version:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman pull latest
tensorman pull 1.14.0
</code></pre></div></div>

<h1 id="running-commands-in-containers">Running commands in containers</h1>

<p>Commands are executed within the container using the <code class="language-plaintext highlighter-rouge">run</code> command.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Default container version with Bash prompt</span>
tensorman run bash

<span class="c"># Default container version with Python script</span>
tensorman run python <span class="nt">--</span> script.py

<span class="c"># Default container version with GPU support</span>
tensorman run <span class="nt">--gpu</span> bash

<span class="c"># With GPU, Python3, and Juypyter support</span>
tensorman run <span class="nt">--gpu</span> <span class="nt">--python3</span> <span class="nt">--jupyter</span> bash
</code></pre></div></div>

<h3 id="python-api-example">Python API example</h3>

<p>Given the following example, which will print a “Hello World” message, the TensorFlow version, and the output of a calculation made using the GPU:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#!/usr/bin/python3
import tensorflow as tf
hello = tf.constant('Hello, TensorFlow!')
tf.print(hello)
tf.print('Using TensorFlow version: ' + tf.__version__)
with tf.device('/gpu:0'):
    a = tf.constant([1.0, 2.0, 3.0, 4.0, 5.0, 6.0], shape=[2, 3], name='a')
    b = tf.constant([1.0, 2.0, 3.0, 4.0, 5.0, 6.0], shape=[3, 2], name='b')
    c = tf.matmul(a, b)
tf.print(c)
</code></pre></div></div>

<p>If the Python file is named <code class="language-plaintext highlighter-rouge">hello-world.py</code>, it can be run with TensorFlow using this command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman run --gpu python ./hello-world.py
</code></pre></div></div>

<h1 id="setting-per-run">Setting per-run</h1>

<p>If a certain version is specified with the <code class="language-plaintext highlighter-rouge">+</code> argument, Tensorman will use that version instead.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman +1.14.0 run <span class="nt">--python3</span> <span class="nt">--gpu</span> bash
</code></pre></div></div>

<p>Custom images may be specified with an <code class="language-plaintext highlighter-rouge">=</code> argument.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman <span class="o">=</span>custom-image run <span class="nt">--gpu</span> bash
</code></pre></div></div>

<h1 id="setting-per-project">Setting per-project</h1>

<p>There are two files that can be used for configuring Tensorman locally: <code class="language-plaintext highlighter-rouge">tensorflow-toolchain</code>, and <code class="language-plaintext highlighter-rouge">Tensorman.toml</code>. These files will be automatically detected if they can be found in a parent directory.</p>

<h2 id="tensorflow-toolchain">tensorflow-toolchain</h2>

<p>This file overrides the tensorflow image, defined in either <code class="language-plaintext highlighter-rouge">Tensorman.toml</code> or the user-wide configuration file.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.14.0 gpu python3
</code></pre></div></div>

<p>Or specifying a custom image:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">=</span>custom-image gpu
</code></pre></div></div>

<h2 id="tensormantoml">Tensorman.toml</h2>

<p>This file supports additional configuration parameters, with a user-wide configuration located at <code class="language-plaintext highlighter-rouge">~/.config/tensorman/config.toml</code>, and a project-wide location at <code class="language-plaintext highlighter-rouge">Tensorman.toml</code>. One of the reasons you may want to use this file is to declare some additional Docker flags, with the <code class="language-plaintext highlighter-rouge">docker_flags</code> key.</p>

<p>Using a default TensorFlow image:</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">docker_flags</span> <span class="p">=</span> <span class="p">[</span> <span class="s">'-p'</span><span class="p">,</span> <span class="s">'8080:8080'</span> <span class="p">]</span>
<span class="py">tag</span> <span class="p">=</span> <span class="s">'2.0.0'</span>
<span class="py">variants</span> <span class="p">=</span> <span class="p">[</span><span class="s">'gpu'</span><span class="p">,</span> <span class="s">'python3'</span><span class="p">]</span>
</code></pre></div></div>

<p>Defining a custom image:</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">docker_flags</span> <span class="p">=</span> <span class="p">[</span> <span class="s">'-p'</span><span class="p">,</span> <span class="s">'8080:8080'</span> <span class="p">]</span>
<span class="py">image</span> <span class="p">=</span> <span class="s">'custom-image'</span>
<span class="py">variants</span> <span class="p">=</span> <span class="nn">['gpu']</span>
</code></pre></div></div>

<h1 id="setting-per-user">Setting per-user</h1>

<p>The default version user-wide can be changed using the <code class="language-plaintext highlighter-rouge">default</code> subcommand. This version of <u>TensorFlow</u> will be launched whenever the <code class="language-plaintext highlighter-rouge">tensorman run</code> command is used:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman default 1.14.0
tensorman default latest gpu python3
tensorman default nightly
tensorman default <span class="o">=</span>custom-image gpu
</code></pre></div></div>

<p><small>* By default, Tensorman will use the latest as the default per-user version tag.</small></p>

<h1 id="listing-active-container-version">Listing active container version</h1>

<p>If the active containers from the current working directory need to be listed, the <code class="language-plaintext highlighter-rouge">show</code> command can be used:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman show
</code></pre></div></div>

<h1 id="removing-containers">Removing containers</h1>

<p>Having many containers installed at the same time can use a lot of disk space. If some need to be removed, the <code class="language-plaintext highlighter-rouge">remove</code> command can be used:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman remove 1.14.0
tensorman remove latest
tensorman remove 481cb7ea88260404
tensorman remove =custom-image
</code></pre></div></div>

<h1 id="listing-installed-containers">Listing installed containers</h1>

<p>To find installed containers, the <code class="language-plaintext highlighter-rouge">list</code> command can be used:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman list
</code></pre></div></div>

<h1 id="creating-a-custom-image">Creating a custom image</h1>

<p>In most projects, you will need to pull in more dependencies than the base TensorFlow image has. To do this, you will need to create the image by running a TensorFlow container as root, installing and setting up the environment how you need it, and then saving those changes as a new custom image.</p>

<p>To do so, you will need to build the container in one terminal, and save it from another.</p>

<h2 id="build-new-image">Build new image</h2>

<p>First, launch a terminal where you will begin configuring the Docker image:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman run <span class="nt">--gpu</span> <span class="nt">--python3</span> <span class="nt">--root</span> <span class="nt">--name</span> CONTAINER_NAME bash
</code></pre></div></div>

<p>Once you’ve made the changes needed, open another terminal and save it as a new image:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman save CONTAINER_NAME IMAGE_NAME
</code></pre></div></div>

<h2 id="running-the-custom-image">Running the custom image</h2>

<p>You should then be able to specify that container with Tensorman, like so:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman <span class="o">=</span>IMAGE_NAME run <span class="nt">--gpu</span> bash
</code></pre></div></div>

<blockquote>
  <p>The <code class="language-plaintext highlighter-rouge">--python3</code> and <code class="language-plaintext highlighter-rouge">--jupyter</code> flags do nothing for custom containers, but <code class="language-plaintext highlighter-rouge">--gpu</code> is required to enable runtime support for the GPU.</p>
</blockquote>

<h2 id="removing-the-custom-image">Removing the custom image</h2>

<p>Images saved through Tensorman are manageable through Tensorman. Listing and removing work the same way:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorman remove IMAGE_NAME
</code></pre></div></div>

<h1 id="pull-requests-welcome">Pull requests welcome!</h1>

<p>To see the source code and suggest features, visit the project on <a href="https://github.com/pop-os/tensorman">GitHub</a>.</p>

    </div>
    <div class="small-12 small-centered medium-10 large-8 columns timestamp">
        <p>Article last modified: 2021-04-09</p>
    </div>
</div>

    </div>
    <footer id="foot">
    <div id="foot-links" class="row">
        <ul class="small-5 medium-2 columns">
            <li><a href="https://system76.com/contact">Contact</a></li>
            <li><a href="https://system76.com/support">Support</a></li>
            <li><a href="https://system76.com/about">About Us</a></li>
            <li><a href="http://blog.system76.com">Blog</a></li>
            <li><a href="https://system76.com/careers">Careers</a></li>
        </ul>
        <ul class="small-7 medium-4 columns">
            <li><a href="https://system76.com/shipping">Shipping Information</a></li>
            <li><a href="https://system76.com/warranty">Warranty &amp; Returns</a></li>
            <li><a href="https://system76.com/privacy">Privacy Policy</a></li>
            <li><a href="https://system76.com/disclaimer">Disclaimer</a></li>
            <li><a href="https://system76.com/terms">Terms &amp; Conditions</a></li>
        </ul>
        <ul id="social-links" class="small-12 medium-6 columns">
            <li><a href="https://www.facebook.com/system76/"><i class="fa fa-facebook"></i></a></li>
            <li><a href="https://twitter.com/system76/"><i class="fa fa-twitter"></i></a></li>
            <li><a href="https://www.pinterest.com/system76/"><i class="fa fa-pinterest"></i></a></li>
        </ul>
    </div>
    <div id="copyright" class="text-center">Copyright &copy; 2021 System76, Inc. </div>

    <div class="disclaimer text-center">* All financing prices are based on the advertised price at 10% APR paid over 12 months.</div>

    <div id="trademarks" class="text-center">Intel, the Intel Logo, Intel Core, and Xeon are trademarks of Intel Corporation in the U.S. and/or other countries.</div>
</footer>

<script src="https://system76.com/scripts/thinkbott1k.js"></script>

<!--[if lt IE 10]>
<div id="legacy-warning">
<h1>System76 is built on modern web technologies your browser doesn&rsquo;t support.</h1>
<p>This version of Internet Explorer is out of date and may contain bugs or security vulnerabilities. Please <a href="http://browsehappy.com/">upgrade</a> to IE 11 or an alternative web browser.</p>
<p>If you have questions about an order or require support, feel free to <a href="/contact">contact us</a>.</p>
<div id="legacy-warning-buttons">
<a href="#" onClick="document.getElementById('legacy-warning').style.display = 'none';">Dismiss</a>
<a class="primary" href="http://browsehappy.com/">Learn More</a>
</div>
</div>
<![endif]-->

  </body>
</html>
