<p>Sound settings or packages related to the sound system can become corrupt or broken. Many times, deleting the configuration files, reinstalling the sound-related packages, and reloading ALSA and/or PulseAudio can help. These commands can also help fix the <u>Sound</u> settings showing “Dummy Output” as the audio output.</p>

<h2 id="reset-pulseaudio">Reset PulseAudio</h2>

<p>If the system is not playing audio, first try restarting the PulseAudio daemon:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl --user restart pulseaudio
</code></pre></div></div>

<p>After restarting the daemon, applications may need to be restarted to re-connect to PulseAudio. If the system still isn’t playing sound, then try removing the user configuration files for PulseAudio:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rm -r ~/.config/pulse
</code></pre></div></div>

<p>Then, kill all instances of PulseAudio:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pulseaudio -k
</code></pre></div></div>

<p>When PulseAudio starts again (which it should do automatically), it will create new configuration files.</p>

<h2 id="check-the-pulseaudio-controls">Check the PulseAudio Controls</h2>

<p>The program <u>PulseAudio Volume Control</u> is helpful in figuring out which program is producing audio, where that audio is being routed, what the default input/output devices are, and what the volume levels are set to.  It can be installed using the Pop!_Shop, or with this command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt install pavucontrol
</code></pre></div></div>

<p>Once installed, open the <u>PulseAudio Volume Control</u> app in the Activities menu, or run <code class="language-plaintext highlighter-rouge">pavucontrol</code> in a terminal.</p>

<p>The “Playback” tab will show a list of applications that are currently playing audio. The volume for each application can be individually controlled.</p>

<p><img src="/images/audio/pavucontrol-playback.png" alt="Playback tab" /></p>

<p>Similarly, the “Recording” tab will show a list of applications that are currently recording audio.</p>

<p><img src="/images/audio/pavucontrol-recording.png" alt="Recording tab" /></p>

<p>The “Output Devices” tab shows a list of output devices, and an indicator of what’s being played out of each device. The green checkmark being selected indicates a device is the default output device.</p>

<p><img src="/images/audio/pavucontrol-output.png" alt="Output tab" /></p>

<p>The “Input Devices” tab shows a similar list for input devices.</p>

<p><img src="/images/audio/pavucontrol-input.png" alt="Input tab" /></p>

<p>Under “Configuration,” each sound card should be listed.</p>

<p><img src="/images/audio/pavucontrol-configuration.png" alt="Configuration tab" /></p>

<h2 id="troubleshooting-alsa">Troubleshooting ALSA</h2>

<p>PulseAudio sits on top of ALSA. If PulseAudio is not seeing any input/output devices, check what playback devices ALSA is detecting:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aplay -l
</code></pre></div></div>

<p>Or, check what recording devices ALSA is detecting:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arecord -l
</code></pre></div></div>

<p>A device may be muted in the ALSA mixer, which will override any PulseAudio volume settings. You can open the ALSA mixer with this command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alsamixer
</code></pre></div></div>

<p>You can navigate between the different volume meters using the left and right arrow keys. Each meter can be adjusted using the up and down arrow keys. An “MM” at the bottom of a meter indicates that meter is muted. If the PulseAudio Volume Control shows that sound is playing, but you don’t hear any sound, try unmuting all of the volume meters in alsamixer by pressing the <kbd>M</kbd> key while each meter is selected.</p>

<p><img src="/images/audio/alsamixer-main.png" alt="alsamixer" /></p>

<p>If your system has more than one sound card (for example, an Intel sound card and an NVIDIA sound card in switchable-graphics systems), you can switch between them by pressing F6.</p>

<p><img src="/images/audio/alsamixer-soundcard.png" alt="alsamixer's sound card selection" /></p>

<h2 id="check-if-hardware-is-detected">Check if Hardware is Detected</h2>

<p>If ALSA doesn’t list a sound card, it may not be physically detected by the system at all. If the Linux kernel sees a sound card, it will show up in your <code class="language-plaintext highlighter-rouge">lspci</code> output. This command will list every sound card your system detects, and show the driver being used for each one:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lspci -v | grep -A6 Audio
</code></pre></div></div>

<p>If the output from that command is blank, then your system isn’t detecting any sound cards (which could indicate a hardware issue.)</p>

<h2 id="other-useful-commands">Other Useful Commands</h2>

<p>This command will reinstall ALSA and some of the other core audio packages:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt install --reinstall alsa-base alsa-utils pulseaudio linux-sound-base libasound2
</code></pre></div></div>

<p>This command will reload the sound driver modules:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo alsa force-reload
</code></pre></div></div>

<p>This command will start PulseAudio after it’s been stopped (this is not usually needed, because PulseAudio will usually restart itself when it’s stopped):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pulseaudio --start
</code></pre></div></div>

<h2 id="configuration-tweaks">Configuration Tweaks</h2>

<p>Some particular problems may be solved by tweaks to ALSA or PulseAudio configuration.</p>

<h3 id="audio-crackling-or-hardware-clicking">Audio crackling or hardware clicking</h3>

<p>If you hear audio crackling (especially when you start or stop playing audio), PulseAudio may be putting your audio card to sleep too often. This is known to happen on the <a href="/articles/serval-dac/">serw12</a> and some <a href="https://github.com/system76/docs/issues/491">Thunderbolt docks</a>.</p>

<p>These two commands will disable this behavior and restart PulseAudio:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo sed -i 's/load-module module-suspend-on-idle/#load-module module-suspend-on-idle/' /etc/pulse/default.pa
pulseaudio -k
</code></pre></div></div>

<p>This change can be undone using these commands:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo sed -i 's/#load-module module-suspend-on-idle/load-module module-suspend-on-idle/' /etc/pulse/default.pa
pulseaudio -k
</code></pre></div></div>

<h3 id="pciinternal-sound-card-not-detected-dummy-output">PCI/internal sound card not detected (dummy output)</h3>

<p>With hardware that uses the <code class="language-plaintext highlighter-rouge">snd_hda_intel</code> kernel module, rare <a href="https://bugs.launchpad.net/ubuntu/+source/linux-oem-osp1/+bug/1864061">bugs</a> can cause the sound card to not be detected. If you’re having this issue, try running these commands to force the usage of a specific audio driver:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo "options snd-hda-intel dmic_detect=0" | sudo tee -a /etc/modprobe.d/alsa-base.conf
echo "blacklist snd_soc_skl" | sudo tee -a /etc/modprobe.d/blacklist.conf
</code></pre></div></div>

<p>Reboot after making the changes. If this doesn’t solve the issue, undo the changes using these commands:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo sed -i 's/options snd-hda-intel dmic_detect=0//' /etc/modprobe.d/alsa-base.conf
sudo sed -i 's/blacklist snd_soc_skl//' /etc/modprobe.d/blacklist.conf
</code></pre></div></div>

<p>Then reboot again.</p>

<h2 id="gather-information-for-support">Gather Information for Support</h2>

<p>The <code class="language-plaintext highlighter-rouge">alsa-info</code> command will gather a number of outputs, including some of the above-listed outputs, and package them so they can be shared easily. In a terminal, run the command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alsa-info
</code></pre></div></div>

<p>When the script is finished gathering information, type <kbd>y</kbd> and press Enter to upload your output to the ALSA website, then send the link to Support.</p>

<p><img src="/images/audio/alsa-info.png" alt="alsa-info" /></p>
